<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kinh Do Foods | Contact</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="age-gate-open">
  <div class="age-gate-backdrop" id="age-gate" role="dialog" aria-modal="true" aria-labelledby="age-gate-title">
    <div class="age-gate-modal">
      <button type="button" class="age-gate-close" id="age-gate-close" aria-label="Đóng cửa sổ xác minh tuổi">
        <span aria-hidden="true">&times;</span>
      </button>
      <h2 id="age-gate-title" data-i18n="ageGateTitle">Xác nhận độ tuổi</h2>
      <p class="age-gate-description" data-i18n="ageGateDescription">Chọn năm sinh của bạn để tiếp tục vào Kinh Đô Foods.</p>
      <div class="age-picker" role="group">
        <div
          class="age-picker-wheel"
          id="age-picker"
          role="listbox"
          aria-label="Chọn năm sinh của bạn"
          tabindex="0"
        >
          <ul class="age-picker-options" id="age-picker-list"></ul>
        </div>
        <div class="age-picker-highlight" aria-hidden="true"></div>
      </div>
      <p class="age-gate-disclaimer">
        <em>*This data will not be stored anywhere.</em><br />
        <em>*Dữ liệu này sẽ không được lưu trữ ở bất kỳ đâu.</em>
      </p>
      <p class="age-gate-footnote" id="age-gate-footnote" aria-live="polite"></p>
      <button class="btn btn-primary age-gate-confirm" type="button" id="age-gate-confirm" data-i18n="ageGateConfirm">
        Vào trang web
      </button>
    </div>
  </div>
  <header class="site-header">
    <div class="container nav-bar">
      <a class="brand" href="index.html">
        <img src="logo-kinh-do-635x516-152344819.png" alt="Kinh Do Foods logo" />
      </a>
      <nav aria-label="Primary">
        <ul>
          <li><a data-i18n="navHome" href="index.html">Trang chủ</a></li>
          <li><a data-i18n="navProducts" href="products.html">Sản phẩm</a></li>
          <li><a class="active" aria-current="page" data-i18n="navContact" href="contact.html">Liên hệ</a></li>
        </ul>
      </nav>
      <div class="header-actions">
        <button class="btn btn-ghost language-toggle" type="button" id="language-toggle" aria-label="Switch to Vietnamese">
          Tiếng Việt
        </button>
        <a class="btn btn-primary" data-i18n="navEmail" href="mailto:hello@kinhdo.com">Gửi email</a>
      </div>
    </div>
  </header>

  <main>
    <section class="hero contact-hero">
      <div class="container">
        <div class="hero-note hero-content">
          <span class="hero-eyebrow" data-i18n="heroEyebrow">Chúng tôi luôn sẵn sàng</span>
          <h1 data-i18n="heroTitle">Kết nối cùng đội ngũ Kinh Đô</h1>
          <p data-i18n="heroDescription">
            Dù bạn đang chuẩn bị tiệc Trung Thu, thiết kế quà tặng doanh nghiệp hay chỉ đơn giản muốn thưởng thức món bánh yêu
            thích, các chuyên viên của chúng tôi luôn sẵn sàng hỗ trợ.
          </p>
          <div class="cta-group">
            <a class="btn btn-primary" data-i18n="heroPrimaryCta" href="mailto:hello@kinhdo.com">Gửi lời chào</a>
            <a class="btn btn-ghost" data-i18n="heroSecondaryCta" href="tel:+8402839499888">Gọi đến flagship</a>
          </div>
        </div>
        <div class="card hero-card">
          <span class="card-overline" data-i18n="contactCardOverline">Giờ đón khách</span>
          <h2 data-i18n="contactCardTitle">Flagship TP. Hồ Chí Minh</h2>
          <p data-i18n="contactCardDescription">Mở cửa hằng ngày 9:00 – 21:00 với phiên thử bánh cuối tuần dành riêng cho bạn.</p>
          <div class="hero-card-footer">
            <span data-i18n="contactCardFootnote1">141 Nguyễn Du, Quận 1</span>
            <span data-i18n="contactCardFootnote2">Đặt lịch trải nghiệm hôm nay</span>
          </div>
        </div>
      </div>
    </section>

    <section id="contact-details">
      <div class="container">
        <div class="contact">
          <div class="section-heading">
            <h2 data-i18n="contactHeading">Đến thăm, gọi điện hoặc hợp tác</h2>
            <p data-i18n="contactIntro">Chia sẻ mong muốn của bạn và chúng tôi sẽ kiến tạo bộ sản phẩm, trải nghiệm hay quan hệ hợp tác hoàn hảo.</p>
          </div>
          <div class="contact-details">
            <div class="contact-card">
              <h4 data-i18n="contactVisitTitle">Ghé thăm cửa hàng flagship</h4>
              <p>
                <span data-i18n="contactVisitLine1">141 Nguyễn Du, Quận 1</span><br />
                <span data-i18n="contactVisitLine2">TP. Hồ Chí Minh, Việt Nam</span>
              </p>
            </div>
            <div class="contact-card">
              <h4 data-i18n="contactSayTitle">Gửi lời chào</h4>
              <p>
                <a href="mailto:hello@kinhdo.com">hello@kinhdo.com</a><br />
                <a href="tel:+8402839499888">+84 (0)28 3949 9888</a>
              </p>
            </div>
            <div class="contact-card">
              <h4 data-i18n="contactPartnersTitle">Đối tác kinh doanh</h4>
              <p>
                <a href="mailto:partners@kinhdo.com">partners@kinhdo.com</a><br />
                <span data-i18n="contactPartnersDescription">Chương trình bánh trung thu &amp; quà tặng theo yêu cầu</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section>
      <div class="container cta-banner">
        <h3 data-i18n="ctaBannerHeading">Đặt lịch thử bánh hoặc tư vấn</h3>
        <p data-i18n="ctaBannerText">Hãy cho chúng tôi biết mong đợi của bạn và chúng tôi sẽ chuẩn bị mẫu thử, gợi ý phối trà và ý tưởng bao bì thật ấn tượng.</p>
        <a class="btn btn-ghost" data-i18n="ctaBannerButton" href="mailto:partners@kinhdo.com">Đặt lịch hẹn</a>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <small>&copy; <span id="year"></span> <span data-i18n="footerCopy">Kinh Do Foods. Bảo lưu mọi quyền.</span></small>
      <small><span data-i18n="footerSocial">Theo dõi hành trình của chúng tôi trên</span> <a href="#">Instagram</a> · <a href="#">Facebook</a> · <a href="#">YouTube</a></small>
    </div>
  </footer>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    const translations = {
      en: {
        navHome: 'Home',
        navProducts: 'Products',
        navContact: 'Contact',
        navEmail: 'Email Us',
        heroEyebrow: 'We’re here to help',
        heroTitle: 'Connect With the Kinh Do Team',
        heroDescription:
          'Whether you are planning a Mid-Autumn soirée, designing a corporate gifting experience, or simply craving your favourite treats, our specialists are ready to support you.',
        heroPrimaryCta: 'Say Hello',
        heroSecondaryCta: 'Call Our Flagship',
        contactCardOverline: 'Visiting Hours',
        contactCardTitle: 'Ho Chi Minh City Flagship',
        contactCardDescription: 'Open daily from 9:00 – 21:00 with dedicated tasting sessions every weekend.',
        contactCardFootnote1: '141 Nguyen Du, District 1',
        contactCardFootnote2: 'Reserve a tasting today',
        contactHeading: 'Visit, Call, or Collaborate',
        contactIntro: 'Share your vision with us and we’ll craft the perfect assortment, experience, or partnership.',
        contactVisitTitle: 'Visit Our Flagship',
        contactVisitLine1: '141 Nguyen Du, District 1',
        contactVisitLine2: 'Ho Chi Minh City, Vietnam',
        contactSayTitle: 'Say Hello',
        contactPartnersTitle: 'Business Partnerships',
        contactPartnersDescription: 'Tailored mooncake & gifting programs',
        ctaBannerHeading: 'Schedule a Tasting or Consultation',
        ctaBannerText:
          'Let us know your goals and we’ll curate samples, pairings, and packaging ideas that wow your guests.',
        ctaBannerButton: 'Book an Appointment',
        footerCopy: 'Kinh Do Foods. All rights reserved.',
        footerSocial: 'Follow our journey on',
        ageGateTitle: 'Confirm Your Age',
        ageGateDescription: 'Select your birth year to continue to Kinh Do Foods.',
        ageGateConfirm: 'Enter Website'
      },
      vi: {
        navHome: 'Trang chủ',
        navProducts: 'Sản phẩm',
        navContact: 'Liên hệ',
        navEmail: 'Gửi email',
        heroEyebrow: 'Chúng tôi luôn sẵn sàng',
        heroTitle: 'Kết nối cùng đội ngũ Kinh Đô',
        heroDescription:
          'Dù bạn đang chuẩn bị tiệc Trung Thu, thiết kế quà tặng doanh nghiệp hay chỉ đơn giản muốn thưởng thức món bánh yêu thích, các chuyên viên của chúng tôi luôn sẵn sàng hỗ trợ.',
        heroPrimaryCta: 'Gửi lời chào',
        heroSecondaryCta: 'Gọi đến flagship',
        contactCardOverline: 'Giờ đón khách',
        contactCardTitle: 'Flagship TP. Hồ Chí Minh',
        contactCardDescription: 'Mở cửa hằng ngày 9:00 – 21:00 với phiên thử bánh cuối tuần dành riêng cho bạn.',
        contactCardFootnote1: '141 Nguyễn Du, Quận 1',
        contactCardFootnote2: 'Đặt lịch trải nghiệm hôm nay',
        contactHeading: 'Đến thăm, gọi điện hoặc hợp tác',
        contactIntro: 'Chia sẻ mong muốn của bạn và chúng tôi sẽ kiến tạo bộ sản phẩm, trải nghiệm hay quan hệ hợp tác hoàn hảo.',
        contactVisitTitle: 'Ghé thăm cửa hàng flagship',
        contactVisitLine1: '141 Nguyễn Du, Quận 1',
        contactVisitLine2: 'TP. Hồ Chí Minh, Việt Nam',
        contactSayTitle: 'Gửi lời chào',
        contactPartnersTitle: 'Đối tác kinh doanh',
        contactPartnersDescription: 'Chương trình bánh trung thu & quà tặng theo yêu cầu',
        ctaBannerHeading: 'Đặt lịch thử bánh hoặc tư vấn',
        ctaBannerText:
          'Hãy cho chúng tôi biết mong đợi của bạn và chúng tôi sẽ chuẩn bị mẫu thử, gợi ý phối trà và ý tưởng bao bì thật ấn tượng.',
        ctaBannerButton: 'Đặt lịch hẹn',
        footerCopy: 'Kinh Do Foods. Bảo lưu mọi quyền.',
        footerSocial: 'Theo dõi hành trình của chúng tôi trên',
        ageGateTitle: 'Xác nhận độ tuổi',
        ageGateDescription: 'Chọn năm sinh của bạn để tiếp tục vào Kinh Đô Foods.',
        ageGateConfirm: 'Vào trang web'
      }
    };

    const AGE_GATE_MESSAGES = {
      error: {
        en: 'Please select your birth year to continue.',
        vi: 'Vui lòng chọn năm sinh để tiếp tục.'
      }
    };
    const AGE_GATE_STORAGE_KEY = 'kinhdoAgeGateStatus';
    const AGE_GATE_BIRTH_YEAR_KEY = 'kinhdoBirthYear';
    const AGE_GATE_YEAR_START = 1945;
    const AGE_GATE_YEAR_END = 2025;
    const AGE_GATE_FILLER_COUNT = 2;

    const translatableElements = document.querySelectorAll('[data-i18n]');
    const languageToggle = document.getElementById('language-toggle');
    const ageGate = document.getElementById('age-gate');
    const agePicker = document.getElementById('age-picker');
    const agePickerList = document.getElementById('age-picker-list');
    const ageGateCloseButton = document.getElementById('age-gate-close');
    const ageGateConfirmButton = document.getElementById('age-gate-confirm');
    const ageGateFootnote = document.getElementById('age-gate-footnote');

    let agePickerOptions = [];
    let agePickerOptionHeight = 0;
    let activeAgeOption = null;
    let selectedBirthYear = null;
    let ageGateInitialized = false;
    let agePickerScrollTimeout;

    const LANGUAGE_STORAGE_KEY = 'kinhdoLanguage';
    const savedLanguage = localStorage.getItem(LANGUAGE_STORAGE_KEY);
    let currentLanguage = savedLanguage === 'en' || savedLanguage === 'vi' ? savedLanguage : 'vi';

    const applyTranslations = (language) => {
      const locale = language === 'vi' ? 'vi' : 'en';
      document.documentElement.setAttribute('lang', locale);

      translatableElements.forEach((element) => {
        const key = element.dataset.i18n;
        const translation = translations[locale][key];

        if (translation) {
          element.textContent = translation;
        }
      });
    };

    const updateToggleLabel = (language) => {
      if (!languageToggle) return;

      if (language === 'vi') {
        languageToggle.textContent = 'English';
        languageToggle.setAttribute('aria-label', 'Switch to English');
      } else {
        languageToggle.textContent = 'Tiếng Việt';
        languageToggle.setAttribute('aria-label', 'Switch to Vietnamese');
      }
    };

    const getAgeGateMessage = (key, locale) => AGE_GATE_MESSAGES[key]?.[locale] ?? '';

    const setAgeGateMessage = (key) => {
      if (!ageGateFootnote) return;

      if (!key) {
        ageGateFootnote.textContent = '';
        delete ageGateFootnote.dataset.messageKey;
        return;
      }

      const locale = currentLanguage === 'vi' ? 'vi' : 'en';
      const message = getAgeGateMessage(key, locale);

      if (message) {
        ageGateFootnote.textContent = message;
        ageGateFootnote.dataset.messageKey = key;
      } else {
        ageGateFootnote.textContent = '';
        delete ageGateFootnote.dataset.messageKey;
      }
    };

    const measureOptionHeight = () => {
      if (!agePickerList) return;
      const sample = agePickerList.querySelector('.age-picker-option:not(.age-picker-spacer)');
      if (sample) {
        agePickerOptionHeight = sample.getBoundingClientRect().height;
      }
    };

    const getActualIndexBounds = () => {
      if (!agePickerOptions.length) {
        return { min: 0, max: 0 };
      }

      return {
        min: AGE_GATE_FILLER_COUNT,
        max: agePickerOptions.length - AGE_GATE_FILLER_COUNT - 1
      };
    };

    const clampToActualIndex = (index) => {
      const bounds = getActualIndexBounds();
      return Math.min(Math.max(index, bounds.min), bounds.max);
    };

    const setActiveAgeOption = (option) => {
      if (activeAgeOption) {
        activeAgeOption.classList.remove('age-option-active');
        activeAgeOption.setAttribute('aria-selected', 'false');
      }

      if (!option || option.classList.contains('age-picker-spacer')) {
        activeAgeOption = null;
        selectedBirthYear = null;
        if (agePicker) {
          agePicker.removeAttribute('aria-activedescendant');
        }
        return;
      }

      option.classList.add('age-option-active');
      option.setAttribute('aria-selected', 'true');
      activeAgeOption = option;
      selectedBirthYear = parseInt(option.dataset.year, 10);
      if (agePicker) {
        agePicker.setAttribute('aria-activedescendant', option.id);
      }
      setAgeGateMessage(null);
    };

    const getScrollTopForIndex = (index) => {
      if (!agePickerOptionHeight) {
        measureOptionHeight();
      }

      if (!agePickerOptionHeight) return 0;

      const bounds = getActualIndexBounds();
      const boundedIndex = Math.min(Math.max(index, bounds.min), bounds.max);
      return (boundedIndex - AGE_GATE_FILLER_COUNT) * agePickerOptionHeight;
    };

    const getIndexFromScrollTop = () => {
      if (!agePickerOptionHeight) {
        measureOptionHeight();
      }

      if (!agePickerOptionHeight) return AGE_GATE_FILLER_COUNT;
      const rawIndex = Math.round(agePicker.scrollTop / agePickerOptionHeight) + AGE_GATE_FILLER_COUNT;
      return clampToActualIndex(rawIndex);
    };

    const scrollToAgeOption = (option, behavior = 'smooth') => {
      if (!agePicker || !option) return;
      if (!agePickerOptionHeight) {
        measureOptionHeight();
      }

      const index = agePickerOptions.indexOf(option);
      if (index === -1 || !agePickerOptionHeight) return;
      const targetTop = getScrollTopForIndex(index);

      if (behavior === 'auto') {
        agePicker.scrollTop = targetTop;
      } else {
        agePicker.scrollTo({ top: targetTop, behavior });
      }

      setActiveAgeOption(option);
    };

    const scrollToYear = (year, behavior = 'smooth') => {
      if (!agePickerOptions.length) return;
      if (year < AGE_GATE_YEAR_START || year > AGE_GATE_YEAR_END) return;

      const offset = AGE_GATE_YEAR_END - year;
      const index = AGE_GATE_FILLER_COUNT + offset;
      const option = agePickerOptions[index];
      if (option) {
        scrollToAgeOption(option, behavior);
      }
    };

    const updateActiveFromScroll = () => {
      if (!agePicker || !agePickerOptionHeight) {
        measureOptionHeight();
      }

      if (!agePicker || !agePickerOptionHeight) return;

      const index = getIndexFromScrollTop();
      const option = agePickerOptions[index];
      if (option && option !== activeAgeOption) {
        setActiveAgeOption(option);
      }
    };

    const snapToNearest = (behavior = 'smooth') => {
      if (!agePicker || !agePickerOptionHeight) return;

      const index = getIndexFromScrollTop();
      const option = agePickerOptions[index];
      if (!option) return;

      const desiredTop = getScrollTopForIndex(index);
      if (Math.abs(agePicker.scrollTop - desiredTop) > 1) {
        if (behavior === 'auto') {
          agePicker.scrollTop = desiredTop;
        } else {
          agePicker.scrollTo({ top: desiredTop, behavior });
        }
      }

      setActiveAgeOption(option);
    };

    const moveAgeSelection = (direction) => {
      if (!activeAgeOption) return;
      const currentIndex = agePickerOptions.indexOf(activeAgeOption);
      if (currentIndex === -1) return;

      const bounds = getActualIndexBounds();
      let nextIndex = currentIndex + direction;
      nextIndex = Math.min(Math.max(nextIndex, bounds.min), bounds.max);

      const option = agePickerOptions[nextIndex];
      if (option) {
        scrollToAgeOption(option);
      }
    };

    const getFocusableAgeGateElements = () => {
      if (!ageGate || ageGate.hidden) return [];

      return Array.from(
        ageGate.querySelectorAll('button, [href], [tabindex]:not([tabindex="-1"])')
      ).filter(
        (element) =>
          !element.hasAttribute('disabled') &&
          element.getAttribute('tabindex') !== '-1' &&
          element.closest('[hidden]') === null
      );
    };

    const hideAgeGate = (immediate = false) => {
      if (!ageGate || ageGate.hidden) return;

      ageGate.setAttribute('aria-hidden', 'true');
      document.body.classList.remove('age-gate-open');

      if (immediate) {
        ageGate.hidden = true;
        ageGate.classList.remove('is-hidden');
        return;
      }

      ageGate.classList.add('is-hidden');
      window.setTimeout(() => {
        if (ageGate.classList.contains('is-hidden')) {
          ageGate.hidden = true;
          ageGate.classList.remove('is-hidden');
        }
      }, 280);
    };

    const showAgeGate = (initial = false) => {
      if (!ageGate) return;

      ageGate.hidden = false;
      ageGate.removeAttribute('aria-hidden');
      document.body.classList.add('age-gate-open');

      if (!initial) {
        ageGate.classList.add('is-hidden');
        requestAnimationFrame(() => {
          ageGate.classList.remove('is-hidden');
        });
      }

      window.setTimeout(() => {
        if (agePicker) {
          agePicker.focus({ preventScroll: true });
        }
      }, 60);
    };

    const updateAgeGateLanguage = (locale) => {
      if (ageGateCloseButton) {
        ageGateCloseButton.setAttribute(
          'aria-label',
          locale === 'vi' ? 'Đóng cửa sổ xác minh tuổi' : 'Close age confirmation'
        );
      }

      if (agePicker) {
        agePicker.setAttribute(
          'aria-label',
          locale === 'vi' ? 'Chọn năm sinh của bạn' : 'Select your birth year'
        );
      }

      if (ageGateConfirmButton) {
        ageGateConfirmButton.setAttribute('aria-label', translations[locale].ageGateConfirm);
      }

      if (ageGateFootnote && ageGateFootnote.dataset.messageKey) {
        const message = getAgeGateMessage(ageGateFootnote.dataset.messageKey, locale);
        if (message) {
          ageGateFootnote.textContent = message;
        }
      }
    };

    const confirmAgeGate = () => {
      if (!selectedBirthYear) {
        setAgeGateMessage('error');
        if (agePicker) {
          agePicker.focus({ preventScroll: true });
        }
        return;
      }

      localStorage.setItem(AGE_GATE_STORAGE_KEY, 'verified');
      localStorage.setItem(AGE_GATE_BIRTH_YEAR_KEY, String(selectedBirthYear));
      setAgeGateMessage(null);
      hideAgeGate();
    };

    const dismissAgeGate = () => {
      localStorage.setItem(AGE_GATE_STORAGE_KEY, 'dismissed');
      setAgeGateMessage(null);
      hideAgeGate();
    };

    const handleAgeGateKeydown = (event) => {
      if (!ageGate || ageGate.hidden) return;

      if (event.key === 'Tab') {
        const focusable = getFocusableAgeGateElements();
        if (!focusable.length) return;

        const first = focusable[0];
        const last = focusable[focusable.length - 1];

        if (event.shiftKey) {
          if (document.activeElement === first || !ageGate.contains(document.activeElement)) {
            last.focus();
            event.preventDefault();
          }
        } else if (document.activeElement === last) {
          first.focus();
          event.preventDefault();
        }
      } else if (event.key === 'Escape') {
        event.preventDefault();
        dismissAgeGate();
      }
    };

    const initializeAgeGate = () => {
      if (ageGateInitialized || !ageGate || !agePicker || !agePickerList) return;
      ageGateInitialized = true;

      const fragment = document.createDocumentFragment();
      const createSpacer = () => {
        const spacer = document.createElement('li');
        spacer.className = 'age-picker-option age-picker-spacer';
        spacer.setAttribute('aria-hidden', 'true');
        spacer.setAttribute('role', 'presentation');
        fragment.appendChild(spacer);
      };

      for (let i = 0; i < AGE_GATE_FILLER_COUNT; i += 1) {
        createSpacer();
      }

      for (let year = AGE_GATE_YEAR_END; year >= AGE_GATE_YEAR_START; year -= 1) {
        const option = document.createElement('li');
        option.className = 'age-picker-option';
        option.dataset.year = String(year);
        option.id = `age-option-${year}`;
        option.setAttribute('role', 'option');
        option.setAttribute('aria-selected', 'false');
        option.textContent = year;
        fragment.appendChild(option);
      }

      for (let i = 0; i < AGE_GATE_FILLER_COUNT; i += 1) {
        createSpacer();
      }

      agePickerList.appendChild(fragment);
      agePickerOptions = Array.from(agePickerList.children);

      measureOptionHeight();

      const storedYear = parseInt(localStorage.getItem(AGE_GATE_BIRTH_YEAR_KEY), 10);
      const defaultYear =
        Number.isInteger(storedYear) &&
        storedYear >= AGE_GATE_YEAR_START &&
        storedYear <= AGE_GATE_YEAR_END
          ? storedYear
          : 2000;

      scrollToYear(defaultYear, 'auto');
      snapToNearest('auto');

      agePicker.addEventListener('scroll', () => {
        updateActiveFromScroll();
        if (agePickerScrollTimeout) {
          clearTimeout(agePickerScrollTimeout);
        }
        agePickerScrollTimeout = window.setTimeout(() => {
          snapToNearest();
        }, 120);
      });

      agePicker.addEventListener('keydown', (event) => {
        if (event.key === 'ArrowUp') {
          event.preventDefault();
          moveAgeSelection(-1);
        } else if (event.key === 'ArrowDown') {
          event.preventDefault();
          moveAgeSelection(1);
        } else if (event.key === 'Home') {
          event.preventDefault();
          const bounds = getActualIndexBounds();
          scrollToAgeOption(agePickerOptions[bounds.min]);
        } else if (event.key === 'End') {
          event.preventDefault();
          const bounds = getActualIndexBounds();
          scrollToAgeOption(agePickerOptions[bounds.max]);
        } else if (event.key === 'Enter') {
          event.preventDefault();
          snapToNearest();
          confirmAgeGate();
        }
      });

      agePicker.addEventListener('focus', () => {
        if (!activeAgeOption) {
          snapToNearest('auto');
        }
      });

      agePickerList.addEventListener('click', (event) => {
        const option = event.target.closest('.age-picker-option');
        if (!option || option.classList.contains('age-picker-spacer')) return;
        scrollToAgeOption(option);
      });

      if (ageGateCloseButton) {
        ageGateCloseButton.addEventListener('click', () => {
          dismissAgeGate();
        });
      }

      if (ageGateConfirmButton) {
        ageGateConfirmButton.addEventListener('click', () => {
          confirmAgeGate();
        });
      }

      ageGate.addEventListener('keydown', handleAgeGateKeydown);

      window.addEventListener('resize', () => {
        const previousHeight = agePickerOptionHeight;
        measureOptionHeight();
        if (
          agePickerOptionHeight &&
          previousHeight !== agePickerOptionHeight &&
          activeAgeOption
        ) {
          scrollToAgeOption(activeAgeOption, 'auto');
        }
      });

      const status = localStorage.getItem(AGE_GATE_STORAGE_KEY);
      if (status === 'verified' || status === 'dismissed') {
        hideAgeGate(true);
      } else {
        showAgeGate(true);
      }
    };

    const siteHeader = document.querySelector('.site-header');
    const mobileHeaderQuery = window.matchMedia('(max-width: 720px)');
    let lastKnownScrollY = window.scrollY;
    let headerHidden = false;

    const showSiteHeader = () => {
      if (!siteHeader || !headerHidden) return;
      siteHeader.classList.remove('is-hidden');
      headerHidden = false;
    };

    const hideSiteHeader = () => {
      if (!siteHeader || headerHidden) return;
      siteHeader.classList.add('is-hidden');
      headerHidden = true;
    };

    const evaluateHeaderVisibility = () => {
      if (!siteHeader) return;

      if (!mobileHeaderQuery.matches) {
        showSiteHeader();
        lastKnownScrollY = window.scrollY;
        return;
      }

      const currentScrollY = Math.max(window.scrollY, 0);
      const isScrollingDown = currentScrollY > lastKnownScrollY;
      const shouldHide = isScrollingDown && currentScrollY > 80;

      if (shouldHide) {
        hideSiteHeader();
      } else {
        showSiteHeader();
      }

      lastKnownScrollY = currentScrollY;
    };

    const resetHeaderVisibility = () => {
      lastKnownScrollY = window.scrollY;
      if (!siteHeader) return;
      siteHeader.classList.remove('is-hidden');
      headerHidden = false;
    };

    if (siteHeader) {
      window.addEventListener('scroll', evaluateHeaderVisibility, { passive: true });
      window.addEventListener('orientationchange', () => {
        resetHeaderVisibility();
        evaluateHeaderVisibility();
      });

      const handleMobileQueryChange = () => {
        resetHeaderVisibility();
        if (mobileHeaderQuery.matches) {
          evaluateHeaderVisibility();
        }
      };

      if (typeof mobileHeaderQuery.addEventListener === 'function') {
        mobileHeaderQuery.addEventListener('change', handleMobileQueryChange);
      } else if (typeof mobileHeaderQuery.addListener === 'function') {
        mobileHeaderQuery.addListener(handleMobileQueryChange);
      }

      evaluateHeaderVisibility();
    }

    const setLanguage = (language) => {
      const locale = language === 'vi' ? 'vi' : 'en';
      currentLanguage = locale;
      applyTranslations(locale);
      updateToggleLabel(locale);
      updateAgeGateLanguage(locale);
      localStorage.setItem(LANGUAGE_STORAGE_KEY, locale);
    };

    if (languageToggle) {
      languageToggle.addEventListener('click', () => {
        setLanguage(currentLanguage === 'en' ? 'vi' : 'en');
      });
    }

    setLanguage(currentLanguage);
    initializeAgeGate();
  </script>
</body>
</html>
